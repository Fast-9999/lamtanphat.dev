{{ define "main" }}
<div class="contact-page">
    <!-- Hero Section -->
    <section class="contact-hero">
        <div class="container">
            <div class="contact-hero__content">
                <h1 class="contact-hero__title">{{ .Title }}</h1>
                <p class="contact-hero__description">{{ .Params.description }}</p>
            </div>
        </div>
    </section>

    <!-- Main Contact Content -->
    <section class="contact-main">
        <div class="container">
            <div class="contact-layout">
                <!-- Left Column - Main Content -->
                <div class="contact-layout__left">
                    <!-- Welcome Message -->
                    <div class="contact-welcome">
                        <h2 class="contact-welcome__title">M√¨nh r·∫•t vui khi ƒë∆∞·ª£c k·∫øt n·ªëi v·ªõi b·∫°n ƒë·ªçc! üöÄ</h2>
                        <p class="contact-welcome__text">
                            D√π b·∫°n c√≥ m·ªôt c√¢u h·ªèi, m·ªôt g√≥p √Ω hay m·ªôt c∆° h·ªôi h·ª£p t√°c, ƒë·ª´ng ng·∫ßn ng·∫°i li√™n h·ªá v·ªõi m√¨nh nh√©. 
                            M√¨nh lu√¥n s·∫µn s√†ng l·∫Øng nghe v√† chia s·∫ª kinh nghi·ªám t·ª´ c·ªông ƒë·ªìng l·∫≠p tr√¨nh vi√™n.
                        </p>
                    </div>

                    <!-- Contact Reasons -->
                    <div class="contact-reasons">
                        <h3 class="contact-reasons__title">B·∫°n c√≥ th·ªÉ li√™n h·ªá v·ªõi m√¨nh ƒë·ªÉ:</h3>
                        <div class="contact-reasons__grid">
                            <div class="contact-reason">
                                <div class="contact-reason__icon">
                                    <i class="fas fa-handshake"></i>
                                </div>
                                <div class="contact-reason__content">
                                    <h4>Th·∫£o lu·∫≠n v·ªÅ c∆° h·ªôi h·ª£p t√°c d·ª± √°n</h4>
                                    <p>Freelance, consulting, ho·∫∑c c√°c d·ª± √°n th√∫ v·ªã</p>
                                </div>
                            </div>
                            <div class="contact-reason">
                                <div class="contact-reason__icon">
                                    <i class="fas fa-comments"></i>
                                </div>
                                <div class="contact-reason__content">
                                    <h4>G√≥p √Ω v·ªÅ n·ªôi dung b√†i vi·∫øt</h4>
                                    <p>ƒê·ªÅ xu·∫•t ch·ªß ƒë·ªÅ m·ªõi ho·∫∑c ph·∫£n h·ªìi v·ªÅ b√†i vi·∫øt hi·ªán t·∫°i</p>
                                </div>
                            </div>
                            <div class="contact-reason">
                                <div class="contact-reason__icon">
                                    <i class="fas fa-question-circle"></i>
                                </div>
                                <div class="contact-reason__content">
                                    <h4>H·ªèi ƒë√°p nhanh v·ªÅ ch·ªß ƒë·ªÅ c·ª• th·ªÉ</h4>
                                    <p>Java, JavaScript, ho·∫∑c c√°c c√¥ng ngh·ªá web kh√°c</p>
                                </div>
                            </div>
                            <div class="contact-reason">
                                <div class="contact-reason__icon">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="contact-reason__content">
                                    <h4>T∆∞ v·∫•n ƒë·ªãnh h∆∞·ªõng ngh·ªÅ nghi·ªáp</h4>
                                    <p>Cho sinh vi√™n CNTT v√† developers m·ªõi v√†o ngh·ªÅ</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Important Notice -->
                    <div class="contact-notice">
                        <div class="contact-notice__icon">
                            <i class="fas fa-info-circle"></i>
                        </div>
                        <div class="contact-notice__content">
                            <h4>Xin l∆∞u √Ω quan tr·ªçng:</h4>
                            <p>
                                M√¨nh kh√¥ng th·ªÉ h·ªó tr·ª£ g·ª° l·ªói (debug) c√°c d·ª± √°n c√° nh√¢n qua form n√†y. 
                                B·∫°n c√≥ th·ªÉ ƒë·∫∑t c√°c c√¢u h·ªèi k·ªπ thu·∫≠t chung trong ph·∫ßn b√¨nh lu·∫≠n c·ªßa c√°c b√†i vi·∫øt li√™n quan ƒë·ªÉ c·ªông ƒë·ªìng c√πng th·∫£o lu·∫≠n.
                            </p>
                        </div>
                    </div>

                    <!-- Response Time -->
                    <div class="contact-response-time">
                        <div class="contact-response-time__icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="contact-response-time__content">
                            <h4>Th·ªùi gian ph·∫£n h·ªìi:</h4>
                            <p>M√¨nh s·∫Ω c·ªë g·∫Øng tr·∫£ l·ªùi email c·ªßa b·∫°n trong v√≤ng <strong>2-3 ng√†y l√†m vi·ªác</strong>.</p>
                        </div>
                    </div>

                    <!-- Contact Form -->
                    <div class="contact-form-section">
                        <h3 class="contact-form-section__title">G·ª≠i tin nh·∫Øn cho m√¨nh</h3>
                        {{ .Content }}
                    </div>
                </div>

                <!-- Right Column - Contact Info & Social -->
                <div class="contact-layout__right">
                    <!-- Author Photo -->
                    <div class="contact-author">
                        <div class="contact-author__photo">
                            <img src="{{ .Site.Params.author_avatar | default "/images/phat.jpg" }}" alt="{{ .Site.Params.author }}" class="contact-author__image">
                        </div>
                        <div class="contact-author__info">
                            <h4 class="contact-author__name">{{ .Site.Params.author }}</h4>
                            <p class="contact-author__role">{{ .Site.Params.author_bio | default "L·∫≠p tr√¨nh vi√™n & Technical Writer" }}</p>
                        </div>
                    </div>

                    <!-- Direct Contact Methods -->
                    <div class="contact-methods">
                        <h4 class="contact-methods__title">Li√™n h·ªá tr·ª±c ti·∫øp</h4>
                        
                        <!-- Email -->
                        <div class="contact-method">
                            <div class="contact-method__icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="contact-method__content">
                                <h5>Email ch√≠nh th·ª©c</h5>
                                <a href="mailto:{{ .Site.Params.email }}" class="contact-method__link">
                                    {{ .Site.Params.email }}
                                </a>
                                <p class="contact-method__description">C√°ch li√™n h·ªá nhanh nh·∫•t v√† chuy√™n nghi·ªáp nh·∫•t</p>
                            </div>
                        </div>

                        <!-- Social Links -->
                        <div class="contact-social">
                            <h5 class="contact-social__title">K·∫øt n·ªëi tr√™n m·∫°ng x√£ h·ªôi</h5>
                            <div class="contact-social__links">
                                {{ if .Site.Params.github }}
                                <a href="{{ .Site.Params.github }}" class="contact-social__link contact-social__link--github" target="_blank" rel="noopener">
                                    <i class="fab fa-github"></i>
                                    <span>GitHub</span>
                                </a>
                                {{ end }}
                                {{ if .Site.Params.linkedin }}
                                <a href="{{ .Site.Params.linkedin }}" class="contact-social__link contact-social__link--linkedin" target="_blank" rel="noopener">
                                    <i class="fab fa-linkedin-in"></i>
                                    <span>LinkedIn</span>
                                </a>
                                {{ end }}
                            </div>
                        </div>
                    </div>

                    <!-- FAQ Section -->
                    <div class="contact-faq">
                        <h4 class="contact-faq__title">C√¢u h·ªèi th∆∞·ªùng g·∫∑p</h4>
                        <div class="contact-faq__list">
                            <div class="contact-faq__item">
                                <h5 class="contact-faq__question">B·∫°n c√≥ nh·∫≠n c√°c d·ª± √°n freelance kh√¥ng?</h5>
                                <p class="contact-faq__answer">C√≥, m√¨nh s·∫µn s√†ng th·∫£o lu·∫≠n v·ªÅ c√°c d·ª± √°n ph√π h·ª£p v·ªõi chuy√™n m√¥n Java v√† JavaScript.</p>
                            </div>
                            <div class="contact-faq__item">
                                <h5 class="contact-faq__question">M√¨nh c√≥ th·ªÉ s·ª≠ d·ª•ng code c·ªßa b·∫°n kh√¥ng?</h5>
                                <p class="contact-faq__answer">T·∫•t c·∫£ code examples tr√™n blog ƒë·ªÅu c√≥ th·ªÉ s·ª≠ d·ª•ng t·ª± do. Ch·ªâ c·∫ßn ghi credit khi s·ª≠ d·ª•ng.</p>
                            </div>
                            <div class="contact-faq__item">
                                <h5 class="contact-faq__question">B·∫°n c√≥ t·ªï ch·ª©c workshop kh√¥ng?</h5>
                                <p class="contact-faq__answer">Th·ªânh tho·∫£ng m√¨nh c√≥ t·ªï ch·ª©c c√°c bu·ªïi chia s·∫ª online. Theo d√µi blog ƒë·ªÉ c·∫≠p nh·∫≠t th√¥ng tin.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- Google reCAPTCHA v3 -->
<script src="https://www.google.com/recaptcha/api.js?render={{ .Site.Params.recaptcha_site_key }}"></script>

<!-- Custom JavaScript for Contact Page -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // reCAPTCHA variables
    let recaptchaToken = null;
    let recaptchaVerified = false;
    
    // Initialize reCAPTCHA
    grecaptcha.ready(function() {
        grecaptcha.execute('{{ .Site.Params.recaptcha_site_key }}', {action: 'contact_form'}).then(function(token) {
            recaptchaToken = token;
        });
    });
    
    // reCAPTCHA success callback
    window.onRecaptchaSuccess = function(token) {
        recaptchaVerified = true;
        recaptchaToken = token;
    };
    
    // Contact form handling
    const contactForm = document.querySelector('.contact-form__form');
    if (contactForm) {
        contactForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form data
            const formData = new FormData(this);
            const name = formData.get('name');
            const email = formData.get('email');
            const subject = formData.get('subject');
            const message = formData.get('message');
            
            // Basic validation
            if (!name || !email || !message) {
                showNotification('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc.', 'error');
                return;
            }
            
            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showNotification('Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ email h·ª£p l·ªá.', 'error');
                return;
            }
            
            // Check reCAPTCHA
            if (!recaptchaToken) {
                showNotification('ƒêang x√°c th·ª±c b·∫£o m·∫≠t...', 'info');
                return;
            }
            
            // Prepare data for Netlify Forms
            const netlifyData = new FormData();
            netlifyData.append('form-name', 'contact');
            netlifyData.append('name', name);
            netlifyData.append('email', email);
            netlifyData.append('subject', subject || 'Kh√°c');
            netlifyData.append('message', message);
            netlifyData.append('recaptcha-token', recaptchaToken);
            
            // Submit to Netlify Forms
            const submitBtn = this.querySelector('.contact-form__submit');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ƒêang g·ª≠i...';
            submitBtn.disabled = true;
            
            fetch('/', {
                method: 'POST',
                body: netlifyData
            })
            .then(response => {
                if (response.ok) {
                    showNotification('C·∫£m ∆°n b·∫°n ƒë√£ li√™n h·ªá! M√¨nh s·∫Ω ph·∫£n h·ªìi s·ªõm nh·∫•t c√≥ th·ªÉ.', 'success');
                    this.reset();
                    // Reset reCAPTCHA
                    recaptchaToken = null;
                    grecaptcha.ready(function() {
                        grecaptcha.execute('{{ .Site.Params.recaptcha_site_key }}', {action: 'contact_form'}).then(function(token) {
                            recaptchaToken = token;
                        });
                    });
                } else {
                    throw new Error('Network response was not ok');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('ƒê√£ c√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i ho·∫∑c li√™n h·ªá tr·ª±c ti·∫øp qua email.', 'error');
            })
            .finally(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        });
    }
    
    // Notification system
    function showNotification(message, type = 'info') {
        // Remove existing notifications
        const existingNotifications = document.querySelectorAll('.contact-notification');
        existingNotifications.forEach(notification => notification.remove());
        
        // Create notification
        const notification = document.createElement('div');
        notification.className = `contact-notification contact-notification--${type}`;
        notification.innerHTML = `
            <div class="contact-notification__content">
                <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                <span>${message}</span>
            </div>
            <button class="contact-notification__close" onclick="this.parentElement.remove()">
                <i class="fas fa-times"></i>
            </button>
        `;
        
        // Add to page
        document.body.appendChild(notification);
        
        // Auto remove after 5 seconds
        setTimeout(() => {
            if (notification.parentElement) {
                notification.remove();
            }
        }, 5000);
    }
    
    // Smooth scroll for internal links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
    
    // Animate elements on scroll
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('animate-in');
            }
        });
    }, observerOptions);

    // Observe contact reasons
    const contactReasons = document.querySelectorAll('.contact-reason');
    contactReasons.forEach(reason => {
        observer.observe(reason);
    });
    
    // Observe FAQ items
    const faqItems = document.querySelectorAll('.contact-faq__item');
    faqItems.forEach(item => {
        observer.observe(item);
    });
});
</script>
{{ end }}
